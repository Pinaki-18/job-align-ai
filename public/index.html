<!DOCTYPE html>
<html>
<head>
  <title>JobAlign AI</title>
</head>
<body style="background:#111;color:#0ff;font-family:sans-serif">

<h2>Upload Resume (PDF)</h2>

<input type="file" id="resume" accept="application/pdf" />
<button onclick="uploadResume()">Extract Text</button>

<h3>Extracted Resume Text</h3>
<textarea id="resumeText" rows="10" cols="80"></textarea>

<h3>Job Description</h3>
<textarea id="jd" rows="6" cols="80"></textarea>

<br><br>
<button onclick="analyze()">Analyze Match</button>

<h3>Analysis</h3>
<pre id="result"></pre>

<script>
async function uploadResume() {
  const fileInput = document.getElementById("resume");
  if (!fileInput.files.length) {
    alert("Select a PDF first");
    return;
  }

  const formData = new FormData();
  formData.append("file", fileInput.files[0]); // ðŸ”¥ MUST BE "file"

  const res = await fetch("/extract-text", {
    method: "POST",
    body: formData
  });

  const data = await res.json();

  if (!data.success) {
    alert(data.error);
    return;
  }

  document.getElementById("resumeText").value = data.text;
}

async function analyze() {
  const resumeText = document.getElementById("resumeText").value;
  const jobDescription = document.getElementById("jd").value;

  const res = await fetch("/analyze", {
    method: "POST",
    headers: { "Content-Type": "application/json" },
    body: JSON.stringify({ resumeText, jobDescription })
  });

  const data = await res.json();
  document.getElementById("result").innerText = data.analysis;
}
</script>

</body>
</html>
